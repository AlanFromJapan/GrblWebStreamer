{% extends 'master01.html' %}

{% block pagename %} Homepage {% endblock %}

{% block contents %} 
<h1>File process [{{filename}}]</h1>


<table class="process">
    <tr>
        <td>
            <h2>File content</h2>
            <div id="filebody" >{{filebody}}</div>
        </td>
        <td>
            <h2>Actions</h2>
            <form method="post">
                <table class="actions">
                    <tr>
                        <td><input type="submit" value="Frame" /></td>
                        <td>Goes around the border of the work</td>
                    </tr>
                    <tr>
                        <td><input type="submit" value="Simulate" /></td>
                        <td>Runs the job but dynamically overlay the laser power to 1% (visible but not engraving)</td>
                    </tr>
                    <tr>
                        <td><input type="submit" value="Burn" /></td>
                        <td>Runs the job <strong>for real</strong> on the device</td>
                    </tr>
                </table>
                
              </form>
        </td>
    </tr>
</table>

<script lang="javascript">
/* 
 * POOR MAN VERY BASIC REGEX SYNTAX HIGHLIGHTING v(^-^)v 
*/
//Taken from here (one of the solutions at the bottom)
//https://stackoverflow.com/questions/30910516/change-text-color-of-matching-text-from-input-in-javascript
function highlight(pattern, color) {
    var inputText = document.getElementById("filebody");
    var re = new RegExp(pattern, 'g');

    inputText.innerHTML = inputText.innerHTML.replace(re, function (match) {
                    return '<span style="color:'+color+ ';">' + match + '</span>';
                });
}

//do first because the semicolon will miss with the innertext of the next matches 
highlight(";.+", "grey");
//Move actions
highlight("G\\d+", "orange");
//Settings
highlight("M\\d+", "limegreen");
//Laser power
highlight("S\\d+", "pink");
//Move speed
highlight("F\\d+", "yellow");


</script>    
{{ dbg }}
{% endblock %}
